---
// 1. ELIMINADA la propiedad 'title' de la lista de imágenes.
const galleryImages = [
  { src: '/images/gallery/galeria-1.jpg', alt: 'Vista de construcción de obra civil' },
  { src: '/images/gallery/galeria-2.jpg', alt: 'Detalle de proyecto de alcantarillado' },
  { src: '/images/gallery/galeria-3.jpg', alt: 'Viviendas SERVIU finalizadas' },
  { src: '/images/gallery/galeria-4.jpg', alt: 'Instalación de sistema de agua potable' },
  { src: '/images/gallery/galeria-5.jpg', alt: 'Equipo trabajando en terreno' },
  { src: '/images/gallery/galeria-6.jpg', alt: 'Acabados de construcción de alta calidad' },
];
---

<link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />

<section class="carousel-section">
  <div class="fade-overlay left"></div>
  <div class="fade-overlay right"></div>
  <div class="container-wide">
    <div class="carousel-header fade-in">
      <div class="section-title">
        <h2>Nuestros Proyectos en Imágenes</h2>
        <p>Un vistazo a la calidad y el detalle de nuestro trabajo.</p>
      </div>
    </div>
    <div class="swiper fade-in">
      <div class="swiper-wrapper">
        {galleryImages.map(image => (
          <div class="swiper-slide">
            <img src={image.src} alt={image.alt} loading="lazy" />
            <!-- 2. ELIMINADO el div del 'slide-caption' -->
          </div>
        ))}
      </div>
    </div>
    <div class="swiper-controls fade-in">
      <div class="swiper-progress-bar">
        <div class="progress"></div>
      </div>
    </div>
  </div>
</section>

<script is:inline src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const progressBar = document.querySelector('.swiper-progress-bar .progress');
    const swiper = new Swiper('.swiper', {
      loop: true,
      slidesPerView: 'auto',
      centeredSlides: true,
      spaceBetween: 30,
      grabCursor: true,
      autoplay: {
        delay: 5000,
        disableOnInteraction: false,
      },
      on: {
        autoplayTimeLeft(s, time, progress) {
          progressBar.style.setProperty('--progress', 1 - progress);
        },
        slideChange(s) {
          progressBar.style.setProperty('--progress', 1);
        }
      },
      breakpoints: {
        768: { spaceBetween: 40 },
      }
    });
  });
</script>

<style>
  .carousel-section {
    padding: 5rem 0;
    background-color: var(--color-bg-soft);
    position: relative;
  }
  .fade-overlay {
    position: absolute;
    top: 0;
    bottom: 0;
    width: 100px;
    z-index: 2;
    pointer-events: none;
  }
  .fade-overlay.left {
    left: 0;
    background: linear-gradient(to right, var(--color-bg-soft), transparent);
  }
  .fade-overlay.right {
    right: 0;
    background: linear-gradient(to left, var(--color-bg-soft), transparent);
  }
  .container-wide {
    width: 100%;
    max-width: 1600px;
    margin: 0 auto;
  }
  .carousel-header {
    text-align: center;
    margin-bottom: 2.5rem;
    padding: 0 2rem;
  }
  .swiper {
    width: 100%;
  }
  .swiper-slide {
    width: 85%;
    border-radius: 12px;
    overflow: hidden;
    position: relative;
    aspect-ratio: 16 / 10;
    transition: transform 0.5s ease, box-shadow 0.5s ease;
    box-shadow: var(--shadow-sm);
  }
  @media (min-width: 768px) { .swiper-slide { width: 65%; } }
  @media (min-width: 1024px) { .swiper-slide { width: 50%; } }
  .swiper-slide-active {
    transform: scale(1.05);
    box-shadow: var(--shadow-md);
  }
  .swiper-slide img { 
    width: 100%; 
    height: 100%; 
    object-fit: cover; 
  }

  /* 3. ELIMINADOS los estilos para '.slide-caption' */
  
  .swiper-controls {
    width: 80%;
    max-width: 600px;
    margin: 2.5rem auto 0;
  }
  .swiper-progress-bar {
    width: 100%;
    height: 3px;
    background-color: var(--color-border);
    border-radius: 3px;
  }
  .swiper-progress-bar .progress {
    width: 100%;
    height: 100%;
    background-color: var(--color-primario);
    border-radius: 3px;
    transform-origin: left;
    transform: scaleX(var(--progress, 1));
    transition: transform 0.1s linear;
  }
</style>